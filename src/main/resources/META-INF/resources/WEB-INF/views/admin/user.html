<!DOCTYPE html>
<html layout:decorate="~{admin/__admin.html}">
<div layout:fragment="content">
	<script>
		var search = new duice.Map({
			key: '',
			value: '',
			status: ''
		});
		var users = new duice.List();
		var user = new duice.Map();
		var userGroups = new duice.List();
		var userRoles = new duice.List();

		function getUsers() {
			var data = {};
			data[search.get('key')] = search.get('value');
			data.status = search.get('status');
			$.ajax({
				 url: 'user/getUsers'
				,type: 'GET'
				,data: data
				,success: function(data, textStatus, jqXHR) {
					users.fromJson(data);
		   	 	}
			});	
		}
		
		function getUser(id){
			$.ajax({
				 url: 'user/getUser'
				,type: 'GET'
				,data: {id:id}
				,success: function(data, textStatus, jqXHR) {
					console.log(data);
					user.fromJson(data);
					userGroups.fromJson(data.groups);
					userRoles.fromJson(data.roles);
		   	 	}
			});	
		}
		
		$(document).ready(function() {
		    console.log( "ready!" );
		    getUsers();
		});
	</script>
	<!-- ========================================================================== -->
	<!-- title row																	-->
	<!-- ========================================================================== -->
	<div class="app-row" id="test">
		<div class="app-col">
			<h1>Group Management</h1>
		</div>
		<div class="app-col right bottom">
			<span is="duice-ui-scriptlet" data-duice-bind="users">
				return 'Total 12,100 users';
			</span>
		</div>
	</div>
	<hr style="border:0px; border-bottom:solid 2px #eee;"/>

	<!-- ========================================================== -->
	<!-- List|Detail row											-->
	<!-- ========================================================== -->
	<div class="app-row">
		<div class="app-col" style="width:50%;">
			<!-- ========================================================== -->
			<!-- List row													-->
			<!-- ========================================================== -->
			<div class="app-row">
				<div class="app-col">
					<img class="icon" src="/static/image/icon_search_24px.png"/>
					<select is="duice-ui-select" data-duice-bind="search,key" style="width:100px;">
						<option>- select -</option>
						<option value="id">ID</option>
						<option value="name">Name</option>
						<option value="email">Email</option>
					</select>
					<input is="duice-ui-input" type="text" data-duice-bind="search,value" style="width:200px;"/>
					<span class="content-search__label">Status</span>
					<select is="duice-ui-select" data-duice-bind="search,status" style="width:100px;">
						<option>- select -</option>
						<option value="ACTIVE">Active</option>
						<option value="SUSPENDED">Suspended</option>
						<option value="CLOSED">Closed</option>
					</select>
				</div>
				<div class="app-col right">
					<button class="button" onclick="getUsers();">
						<img class="button-icon" src="/static/image/icon_search_16px.png"/>
						Search
					</button>
				</div>
			</div>
			<div class="app-row">
				<div class="app-col">
					<table is="duice-ui-table" 
						data-duice-bind="users,user" 
						data-duice-editable="true"
						style="width:100%;">
						<thead>
							<tr>
								<th>No</th>
								<th>ID</th>
								<th>Name</th>
								<th>Nickname</th>
								<th>Email</th>
								<th>joinDate</th>
								<th>Status</th>
							</tr>
						</thead>
						<tbody data-id="[[$context.user.get('id')]]" onclick="getUser(this.dataset.id);">
							<tr>
								<td><span is="duice-ui-scriptlet" data-duice-bind="users">return $context.index+1;</span></td>
								<td>
									<img is="duice-ui-img" data-duice-bind="user,image" src="/static/image/icon_user_24px.png" style="height:24px;"/>
									<span is="duice-ui-span" data-duice-bind="user,id"></span>
								</td>
								<td><span is="duice-ui-span" data-duice-bind="user,name"></span></td>
								<td><span is="duice-ui-span" data-duice-bind="user,nickname"></span></td>
								<td><span is="duice-ui-span" data-duice-bind="user,email"></span></td>
								<td><span is="duice-ui-span" data-duice-bind="user,joinDate"></span></td>
								<td><span is="duice-ui-span" data-duice-bind="user,status"></span></td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>		
		</div>
		<div class="app-col" style="width:50%;">
			<!-- ========================================================== -->
			<!-- Detail	row													-->
			<!-- ========================================================== -->
			<div class="app-row">
				<div class="app-col">
					<img class="icon" src="/static/image/icon_user_24px.png"/>
					<span style="font-weight:bold;">
						User Details
					</span>
				</div>
				<div class="app-col right">
					<button class="button" onclick="users.reset();">
						<img class="button-icon" src="/static/image/icon_new_16px.png"/>
						New
					</button>
					<button class="button" onclick="users.reset();">
						<img class="button-icon" src="/static/image/icon_delete_16px.png"/>
						Delete
					</button>
					<button class="button" onclick="users.reset();">
						<img class="button-icon" src="/static/image/icon_save_16px.png"/>
						Save
					</button>
				</div>
			</div>
			<div class="app-row">
				<div class="app-col">
					<table class="table" style="width:100%;">
						<col style="width:25%;"/>
						<col/>
						<tbody>
							<tr>
								<th>ID</th>
								<td><input is="duice-ui-input" type="text" data-duice-bind="user,id"/></td>
							</tr>
							<tr>
								<th>Image</th>
								<td><img is="duice-ui-img" data-duice-bind="user,image" style="height:64px;"/></td>
							</tr>
							<tr>
								<th>Name</th>
								<td><input is="duice-ui-input" type="text" data-duice-bind="user,name"/></td>
							</tr>
							<tr>
								<th>Nickname</th>
								<td><input is="duice-ui-input" type="text" data-duice-bind="user,nickname"/></td>
							</tr>
							<tr>
								<th>Status</th>
								<td>
									<select is="duice-ui-select" data-duice-bind="user,status">
										<option> - select - </option>
										<option value="ACTIVE">ACTIVE</option>
										<option value="SUSPENDED">SUSPENDED</option>
										<option value="CLOSED">CLOSED</option>
									</select>
								</td>
							</tr>
							<tr>
								<th>Email</th>
								<td><input is="duice-ui-input" type="text" data-duice-bind="user,email"/></td>
							</tr>
							<tr>
								<th>Phone</th>
								<td><input is="duice-ui-input" type="text" data-duice-bind="user,phone"/></td>
							</tr>
							<tr>
								<th>Locale</th>
								<td>
									<select is="duice-ui-select" data-duice-bind="user,locale">
										<option> - select - </option>
										<option value="en_US">en_US</option>
										<option value="ko_KR">ko_KR</option>
									</select>
								</td>
							</tr>
							<tr>
								<th>Join Date</th>
								<td><input is="duice-ui-input" type="datetime-local" data-duice-bind="user,joinDate" data-duice-format="yyyy.MM.dd HH:mm:ss"/></td>
							</tr>
							<tr>
								<th>Close Date</th>
								<td><input is="duice-ui-input" type="datetime-local" data-duice-bind="user,closeDate" data-duice-format="yyyy.MM.dd HH:mm:ss"/></td>
							</tr>
							<tr>
								<th>Profile</th>
								<td><textarea is="duice-ui-textarea" data-duice-bind="user,profile"></textarea></td>
							</tr>
							<tr>
								<th>
									<img src="/static/image/icon_group_32px.png" style="vertical-align: middle;"/>
									Group
								</th>
								<td>
									<table is="duice-ui-table" 
										data-duice-bind="userGroups,group" 
										data-duice-editable="true"
										style="width:100%;">
										<col style="width:40%;"/>
										<col/>
										<col style="width:5%;"/>
										<thead>
											<tr>
												<th>ID</th>
												<th>Name</th>
												<th>
													<button class="small" data-index="[[$context.index]]" onclick="javascript:removeUserGroup(this.dataset.index);">
														<img class="button-icon" src="/static/image/icon_plus_16px.png"/>
													</button>
												</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>
													<img is="duice-ui-img" data-duice-bind="group,icon" style="height:24px;"/>
													<span is="duice-ui-span" data-duice-bind="group,id"></span>
												</td>
												<td><span is="duice-ui-span" data-duice-bind="group,name"></span></td>
												<td>
													<button class="small" data-index="[[$context.index]]" onclick="javascript:removeUserGroup(this.dataset.index);">
														<img class="button-icon" src="/static/image/icon_minus_16px.png"/>
													</button>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<th>
									<img src="/static/image/icon_role_32px.png" style="vertical-align: middle;"/>
									Role
								</th>
								<td>
									<table is="duice-ui-table" 
										data-duice-bind="userRoles,role" 
										data-duice-editable="true"
										style="width:100%;">
										<col style="width:40%;"/>
										<col/>
										<col style="width:5%;"/>
										<thead>
											<tr>
												<th>ID</th>
												<th>Name</th>
												<th>
													<button class="small" data-index="[[$context.index]]" onclick="javascript:removeUserGroup(this.dataset.index);">
														<img class="button-icon" src="/static/image/icon_plus_16px.png"/>
													</button>
												</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>
													<img is="duice-ui-img" data-duice-bind="role,icon" style="height:24px;"/>
													<span is="duice-ui-span" data-duice-bind="role,id"></span>
												</td>
												<td><span is="duice-ui-span" data-duice-bind="role,name"></span></td>
												<td>
													<button class="small" data-index="[[$context.index]]" onclick="javascript:removeUserGroup(this.dataset.index);">
														<img class="button-icon" src="/static/image/icon_minus_16px.png"/>
													</button>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<th>
									<img src="/static/image/icon_group_32px.png" style="vertical-align: middle;"/>
									Group
								</th>
								<td>
									<table is="duice-ui-table" 
										data-duice-bind="userGroups,group" 
										data-duice-editable="true"
										style="width:100%;">
										<col style="width:40%;"/>
										<col/>
										<col style="width:5%;"/>
										<thead>
											<tr>
												<th>ID</th>
												<th>Name</th>
												<th>
													<button class="small" data-index="[[$context.index]]" onclick="javascript:removeUserGroup(this.dataset.index);">
														<img class="button-icon" src="/static/image/icon_plus_16px.png"/>
													</button>
												</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td>
													<img is="duice-ui-img" data-duice-bind="group,icon" style="height:24px;"/>
													<span is="duice-ui-span" data-duice-bind="group,id"></span>
												</td>
												<td><span is="duice-ui-span" data-duice-bind="group,name"></span></td>
												<td>
													<button class="small" data-index="[[$context.index]]" onclick="javascript:removeUserGroup(this.dataset.index);">
														<img class="button-icon" src="/static/image/icon_minus_16px.png"/>
													</button>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	

	
	
</div>









