<!DOCTYPE html>
<html layout:decorate="~{index.html}">
<div layout:fragment="content">
	<script>
	// document ready
	$(document).ready(function() {
		getArticles();
	});
	
	// defines variables
	const search = new duice.Map({
		key: null,
		value: null,
		status: null,
		page: 1,
		rows: 10,
		totalCount: -1
	});
	const articles = new duice.List();
	
	/**
	 * Gets articles
	 */
	function getArticles(page) {
		return new Promise(function(resolve,reject){
			if(page){
				search.set('page',page);
			}
			var data = {};
			if(search.get('key')){
				data[search.get('key')] = search.get('value');
			}
			if(search.get('status')){
				data.status = search.get('status');
			}
			data.page = search.get('page');
			data.rows = search.get('rows');
			$.ajax({
				 url: '[[@{/api/board}]]/[[${board.id}]]/article'
				,type: 'GET'
				,data: data
			})
			.done(function(data, textStatus, jqXHR) {
				console.log('data',data);
				articles.fromJson(data);
				search.set('totalCount', __parseTotalCount(jqXHR));
				resolve(true);
		   	});
		});
	}
	
	/**
	 * Reads article
	 */
	function readArticle(articleId) {
		window.location.href = "[[@{/board}]]/[[${board.id}]]/readArticle" + "?id=" + articleId;
	}
	</script>
	<th:block th:include="|../theme/application/board/default/board.html|"></th:block>
</div>





