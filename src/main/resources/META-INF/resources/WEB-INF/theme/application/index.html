<!-- ================================================== -->
<!-- START: top											-->
<!-- ================================================== -->
<div class="app-row" style="padding:0px 20px; height:70px; background-color:#fafafa; border-bottom:groove 2px #ccc;">
	<div class="app-col left middle">
		<a th:href="@{/}">
			<img th:src="@{/static/image/application.png}"/>
		</a>
	</div>
	<div class="app-col right middle">
		<img th:src="${__user.photo}" class="icon" style="width:32px; height:32px; border-radius:32px;"/>
		<span data-th-text="${__user.name}" style="font-weight:bold;"></span>
		&nbsp;&nbsp;&nbsp;
		<img class="icon" th:src="@{/static/image/icon_logout.png}"/>
		<span data-th-text="#{application.global.logout}" onclick="__logout();" class="link"></span>
		&nbsp;&nbsp;&nbsp;
		<img class="icon" th:src="@{/static/image/icon_language.png}"/>
		<select class="duice-select" onchange="__changeLanguage(this.value);" style="width:100px;">
			<option th:each="language:${__languages}" th:value="${language.language}" th:text="${language.displayLanguageByLocale}" th:selected="${language.language} == ${#locale.language}"></option>
		</select>
	</div>
</div>
<!-- ================================================== -->
<!-- END: top											-->
<!-- ================================================== -->

<div class="app-row" style="min-height:calc(100% - 120px);">
	<!-- ================================================== -->
	<!-- START: menu										-->
	<!-- ================================================== -->
	<div class="app-col" style="width:250px;">
		<ul is="duice-ul"
		data-duice-bind="__menus,__menu" 
		data-duice-hierarchy="id,upperId"
		data-duice-foldable="false"
		style="margin:1rem;">
			<li>
				<a href="javascript:void(0);" 
				data-link-url="[@duice[$context.__menu.get('linkUrl')]]" 
				data-link-target="[@duice[$context.__menu.get('linkTarget')]]"
				onclick="javascript:__openLink(this.dataset.linkUrl, this.dataset.linkTarget);"
				style="display:block; border-bottom:dotted 1px #ccc; line-height:2.5rem;">
					<img is="duice-img" data-duice-bind="__menu,icon" th:src="@{/static/image/icon_menu.png}" style="width:24px; height:24px;"/>
					<span is="duice-span" data-duice-bind="__menu,name" style="font-weight:bold;"></span>
				</a>
			</li>
		</ul>
	</div>
	<!-- ================================================== -->
	<!-- START: menu										-->
	<!-- ================================================== -->
	<!-- ================================================== -->
	<!-- START: content										-->
	<!-- ================================================== -->
	<div layout:fragment="content" class="app-col" style="width:calc(100% - 500px); padding:1rem;">
		<div id="readme"></div>
		<script>
		$.ajax({
			 url: '[[@{/readme}]]'
			,type: 'GET'
			,success: function(data, textStatus, jqXHR) {
				// parse markdown
				var result = marked(data);
				$('#readme').html(result);
				$('#readme').find('[class^=language-]').each(function(){
					this.classList.add('line-numbers');
				});
				$('#readme').find('table').each(function(){
					this.classList.add('table','table-sm','table-bordered');
				});
				$('#readme').find('[class^=language-plantuml]').each(function(){
					var $this = this;
					var plantumlCode = $(this).text();
					var img = document.createElement('img');
					img.style.width = '100%';
					this.parentNode.replaceChild(img,this);
					var xhr = new XMLHttpRequest();
					xhr.onreadystatechange = function(){
						if (this.readyState == 4 && this.status == 200){
					    	var reader = new FileReader();
					    	reader.onload = function(e) {
					    		img.src = reader.result;
					    	}
					    	reader.readAsDataURL(this.response);
					    }
					}
					xhr.open('POST', '[[@{/plantuml}]]');
					xhr.responseType = 'blob';
					xhr.setRequestHeader("[[${_csrf}?${_csrf.headerName}:'headerName']]","[[${_csrf}?${_csrf.token}:'token']]");
					xhr.setRequestHeader('Cache-Control','no-cache, no-store, must-revalidate');
					xhr.setRequestHeader('Pragma','no-cache');
					xhr.setRequestHeader('Expires','0');
					xhr.send(plantumlCode); 
				});
				// highlight
				Prism.highlightAll();
	    	 }
		});
		</script>
	</div>
	<!-- ================================================== -->
	<!-- END: content										-->
	<!-- ================================================== -->
	<div class="app-col" style="width:250px; padding:1rem;">
	</div>
</div>

<!-- ================================================== -->
<!-- START: footer										-->
<!-- ================================================== -->
<div style="text-align:center; border-top:dotted 1px #ccc;">
	<img th:src="@{/static/image/copyright.png}"/>
</div>
<!-- ================================================== -->
<!-- END: footer										-->
<!-- ================================================== -->

